<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title> | SCRAP.Net </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content=" | SCRAP.Net ">
      
      <link rel="icon" href="../favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/fra00/SCRAP.Net/blob/master/docs-other/com-net-arduino.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">
  </head>

  <script type="module" src="./../public/docfx.min.js"></script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="SCRAP.Net">
            SCRAP.Net
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">

<h3 id="scrapnet-and-arduino-communication-guide">SCRAP.Net and Arduino Communication Guide</h3>
<h2 id="overview">Overview</h2>
<p>SCRAP.Net is the main program that interfaces with the hardware. It breaks down user requests (e.g., &quot;go to the kitchen&quot;) into a series of commands executed by Arduino. Arduino receives these commands, interfaces with the hardware, and once the command is completed, it responds to SCRAP.Net. This process continues until the initial task is completed.</p>
<h2 id="communication-flow">Communication Flow</h2>
<p>Here's an example of how a command to move forward 10 cm is sent and processed:</p>
<pre><code class="lang-mermaid">sequenceDiagram
    participant Net
    participant Arduino
    participant HW

    Net-&gt;&gt;Arduino: Send command forward RPI_105_11_10
    Arduino-&gt;&gt;HW: Start forward execution 
    HW-&gt;&gt;HW: Make moviment
    HW-&gt;&gt;Arduino: Response Arduino ARDU_105_11_$$
    Arduino-&gt;&gt;Net: Response from arduino
</code></pre>
<h2 id="message-format">Message Format</h2>
<p>The data transmission format is structured as follows:</p>
<p><code>[sender]_[id]_[IdCommand]_[param1]_[param2]_[param3]_[param4]_[end]</code></p>
<p>Example:</p>
<p><code>RPI_1_11_10_&amp;&amp;</code></p>
<p>The data transmission format was selected to provide compatibility with various protocols, including serial and HTTP.</p>
<h3 id="components">Components:</h3>
<ul>
<li><strong>[sender]</strong>: Message sender (RPI for SCRAP.Net, ARDU for Arduino)</li>
<li><strong>[id]</strong>: Auto-incremental command identifier</li>
<li><strong>[IdCommand]</strong>: ID of the command to send</li>
<li><strong>[param1...4]</strong>: Optional parameters (arrays are split based on SERIAL_ARRAY_SEPARETOR)</li>
<li><strong>[end]</strong>: End of message string</li>
</ul>
<h2 id="configuration">Configuration</h2>
<p>These parameters can be configured in the <code>Configuration.cs</code> file:</p>
<pre><code>public static string SERIAL_SEPARETOR = &quot;_&quot;; 
public static string SERIAL_ARRAY_SEPARETOR = &quot;;&quot;; 
public static string SERIAL_START_MESSAGE_RPI = &quot;RPI&quot;; 
public static string SERIAL_START_MESSAGE_ARDU = &quot;ARDU&quot;; 
public static string SERIAL_END_MESSAGE = &quot;$$\r\n&quot;;`
</code></pre>
<p>`</p>
<p><strong>IMPORTANT</strong>: The same configurations must be implemented in SCRAP.Arduino and must match, otherwise communication will fail.</p>
<h2 id="command-implementation">Command Implementation</h2>
<p>In SCRAP.Net, all Arduino commands are implemented and declared in the <code>CommandComunication</code> class of the <code>MainRobot.Robot.Comunication</code> namespace.</p>
<h2 id="list-command">List Command</h2>
<table>
<thead>
<tr>
<th>Method Name</th>
<th>Parameter 1</th>
</tr>
</thead>
<tbody>
<tr>
<td>DisableRele1</td>
<td>05</td>
</tr>
<tr>
<td>EnableRele1</td>
<td>06</td>
</tr>
<tr>
<td>DisableRele2</td>
<td>07</td>
</tr>
<tr>
<td>EnableRele2</td>
<td>08</td>
</tr>
<tr>
<td>EnableFakeMoviment</td>
<td>09</td>
</tr>
<tr>
<td>Stop</td>
<td>10</td>
</tr>
<tr>
<td>Forward</td>
<td>11{Configuration.SERIAL_SEPARETOR}{distance}</td>
</tr>
<tr>
<td>StartLeftMotor</td>
<td>12{Configuration.SERIAL_SEPARETOR}{angle}</td>
</tr>
<tr>
<td>StartRightMotor</td>
<td>13{Configuration.SERIAL_SEPARETOR}{angle}</td>
</tr>
<tr>
<td>Backward</td>
<td>16{Configuration.SERIAL_SEPARETOR}{distance}</td>
</tr>
<tr>
<td>EnableMoviment</td>
<td>21</td>
</tr>
<tr>
<td>DisableMoviment</td>
<td>22</td>
</tr>
<tr>
<td>GetLevelOfAlimentation</td>
<td>32</td>
</tr>
<tr>
<td>ReadLidar</td>
<td>33</td>
</tr>
<tr>
<td>DisableObstacleFind</td>
<td>14</td>
</tr>
<tr>
<td>EnableObstacleFind</td>
<td>15</td>
</tr>
<tr>
<td>IsInRecharge</td>
<td>17</td>
</tr>
<tr>
<td>OutInRecharge</td>
<td>18</td>
</tr>
<tr>
<td>GetDistanceFrontSensor</td>
<td>30</td>
</tr>
<tr>
<td>GetSourceOfAlimentation</td>
<td>31</td>
</tr>
<tr>
<td>MoveServo</td>
<td>40{Configuration.SERIAL_SEPARETOR}{numServo}{Configuration.SERIAL_SEPARETOR}{angle}</td>
</tr>
</tbody>
</table>
<ol>
<li>Always ensure that the configuration in SCRAP.Net and SCRAP.Arduino match.</li>
<li>Use meaningful and unique command IDs to avoid confusion.</li>
<li></li>
</ol>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/fra00/SCRAP.Net/blob/master/docs-other/com-net-arduino.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
